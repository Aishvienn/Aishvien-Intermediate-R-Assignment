---
title: "Aishvien Nagendran_Intermediate_R_Assignment"
format: html
theme: yeti
---

## Part 1: R Basics & Tidyverse Essentials
```{r}



#Saving the movies data set and inspecting it
#| warning: FALSE

library(ggplot2)
library(dplyr)
library(tidyr)

movies <- ggplot2movies::movies

str(movies)
class(movies)
typeof(movies)

```

# Questions 3-4
```{r}
# Question 3 Creating a subset of the movies dataset called movies_final. Removed columns r1-r10

movies_final <- movies |> select(-c(r1,r2,r3,r4,r5,r6,r7,r8,r9,r10))

# Question 4a Created a singular genre column, removed films from genres that it did not belong to
movies_final <- movies_final |>
  mutate(across(.cols = c(Action, Animation,Comedy,Drama,Documentary,Romance,Short),
 .fns = ~ ifelse(.x == 1, cur_column(), NA_character_)                                                   )) |>
  unite(
    col = "genre",
    c(Action, Animation, Comedy, Drama, Documentary, Romance, Short),
    sep = ", ",
    na.rm = TRUE
  )
#| you need the tiydr package to use the unite function
#| english translation of code above: take the genre columns and if the value inside the column is
#| 1 take the name of the column. Then combine multiple columns under one column called "genre" and
#| merge them into a single string


str(movies_final) # I used structure function to check if it worked, and it did!

# Question 4b, Omitted missing values in genre column, split rows into unique film-genres 
movies_genre_ratings <- movies_final |> 
  filter(genre != "" & !is.na(genre)) |> 
  tidyr::separate_longer_delim(genre, delim = ", ") |>
  group_by(genre) |> summarise(mean_rating = mean(rating, na.rm = TRUE))
# On average, Documentary, Animation, and Short films have the highest rating while Drama, Comedy, and action have the lowest rating


```

# Question 5a-5b
```{r}
#| label: fig-movies-year-rating

movies_final |> ggplot(aes(x = year, y = rating)) + 
  geom_point() +
  theme_light() + 
  labs(x = "Year", y = "Rating", title = "Film Year and Rating Graph")

#| label: fig-movies-year-rating-line
movies_final |> ggplot(aes(x = year, y = rating)) + 
  geom_line() +
  theme_light() + 
  labs(x = "Year", y = "Rating", title = "Film Year and Rating Graph")

#| label: fig-movies-year-mpaa
movies_final |> ggplot(aes(x = year, y = rating, color = mpaa )) + 
  geom_point() +
  theme_light() + 
  labs(x = "Year", y = "Rating", title = "Film Year and Rating Graph")


#| There seems to be missing data in the mpaa section

```

## Part 2: Functions, Iterations, and Debugging
```{r}
# Question 6a Creating a Roll Dice Function

#| warning: False
library(glue)

roll_dice <- function(d = 20, num_rolls)
   return (sample(1:d, num_rolls, replace = TRUE))
  
print(roll_dice(10, 2))

#Question 6b, modifying Roll Dice Function
roll_dice2 <- function(d = 20, num_rolls) {
  
  if(d < 0 ) warning("Value Error: Please input a positive integer")
  if(num_rolls < 0) warning("Value Error: Please input a positive integer")
  rolls <- sample(1:d, num_rolls, replace = TRUE)
  print(glue("You rolled a {num_rolls} d{d} dice: {paste(rolls, collapse = ', ')}. Sum: {sum(rolls)}"))
  return(rolls)
}

rolls <- roll_dice2(10,100)
```

# Question 7-8b
```{r}

#Question 7a
num_sols <- function(a, b, c) {
  discriminant <- b^2 - 4*a*c
if (discriminant < 0) return("There are no real solutions")
if (discriminant == 0) return("There is one real solution")
if (discriminant > 0) return("There are two real solutions")

  
}
print(num_sols(1,10,2))


#Question 7b
quad_solve <- function(a, b, c){
  discriminant <- b^2 - 4*a*c
if (discriminant < 0) return("There are no real solutions")
if (a == 0) stop("Value error: Input a non-zero integer")
  
plus_squarer <-  (-b + sqrt(discriminant)/ 2*a) #Had to create the minus and plus sign since R has no operator
minus_squarer <- (-b - sqrt(discriminant)/ 2*a)
  
return(c(root1 = plus_squarer, root2 = minus_squarer))

 
}
print(quad_solve(1,10,2))


#Question 8a
collatz <- function(n) {
  steps <- 1
  while (n > 2) {         # I realized that the while condition had to be n < 2 for collatz(2) to work
    if (n %% 2 == 0) {
      n <- n / 2
    } else {
      n <- 3*n + 1
    }
    steps <- steps + 1
  }
  steps
}

collatz(37) #Returns 21

# Question 8b
collatz_steps <- function(n) {
  steps_seq <- c(n)
  while (n > 2) {          
    if (n %% 2 == 0) {
      n <- n / 2
    } else {
      n <- 3*n + 1
    }
    steps_seq <- c(steps_seq, n)
  
  }
 steps <- length(steps_seq) + 1 
  return(list(steps = steps,
              steps_seq = steps_seq))
}

collatz_steps(37)


```

# Question 9-10  
```{r}
scores <- data.frame(
Math = c(88, 92, 76, 81, 95),
English = c(91, 85, 79, 88, 90),
History = c(84, 89, 90, 75, 92),
Science = c(90, 94, 80, 85, 88)
)
rownames(scores) <- c("Alice", "Bob", "Charlie", "David", "Eva")



#Question 9a
apply(scores, 1, mean) #calculate average score for each participant

#Question 9b
apply(scores, 2, mean) #calculate average score for each subject



#Question 10
#| eval: false
average_all <- function(x, y, z) {
combined <- c(x, y, z)
clean <- na.omit(combined)

# Check for empty input
if (length(clean) == 0)
stop("No valid numbers!")

total <- sum(clean)
n <- length(x + y + z)
mean_val <- total / n
return(mean_val)
}

# Try this to see if it works:
x <- c(1, 2, 3, NA)
y <- c(4, 5, NA)
z <- c(6, 7, 8)
mean(1:8) # Correct mean
average_all(x, y, z) # Computed mean

traceback() #The function doesn't help because there isn't technically any actual errors

debug(average_all)
average_all(x, y, z)




#Fixed Code
#| eval: TRUE
average_all <- function(x, y, z) {
combined <- c(x, y, z)
clean <- na.omit(combined)

# Check for empty input
if (length(clean) == 0)
stop("No valid numbers!")

total <- sum(clean)
n <- length(cleam)
mean_val <- total / n
return(mean_val)
}





```
Using the debug function, the issue seems to be at line 206 when the average is being calculated.
My guess is that when you divide vectors of different lengths that are not a multiple of each other it results in a error. For example the length of clean is 8, and n is 3 which also means that 3 is not a multiple of 8. Also another issue is that the value of n is "4L", not sure if that is correct.



To fix the code, replace n<-length(x,y,z) with n<-length(clean).
We were initially using the old vectors containing the NAs and when we added the vectors it contained NA's, which resulted in errors.
